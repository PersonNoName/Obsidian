# 统一响应封装

## 概述

所有 API 接口返回统一格式的响应数据，便于前端处理和错误追踪。

## Result 封装类

**文件位置**: `dto/Result.java`

### 响应结构

```java
@Data
public class Result<T> {
    private Integer code;      // 状态码
    private String message;    // 消息
    private T data;            // 数据
}
```

### 响应格式示例

```json
// 成功响应
{
    "code": 200,
    "message": "success",
    "data": { ... }
}

// 错误响应
{
    "code": 401,
    "message": "用户名或密码错误",
    "data": null
}
```

## 静态工厂方法

### 成功响应

```java
public static <T> Result<T> success(T data) {
    Result<T> result = new Result<>();
    result.setCode(200);
    result.setMessage("success");
    result.setData(data);
    return result;
}

public static <T> Result<T> success() {
    return success(null);
}
```

### 错误响应

```java
public static <T> Result<T> error(Integer code, String message) {
    Result<T> result = new Result<>();
    result.setCode(code);
    result.setMessage(message);
    result.setData(null);
    return result;
}

public static <T> Result<T> error(String message) {
    return error(500, message);
}
```

## 常用状态码

| 状态码 | 说明 |
|--------|------|
| 200 | 成功 |
| 400 | 请求参数错误 |
| 401 | 未授权 / 用户名或密码错误 |
| 403 | 禁止访问 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

## 使用示例

### Controller 层返回成功

```java
@GetMapping("/{id}")
public Result<Map<String, Object>> getSectorDetail(@PathVariable Integer id) {
    Map<String, Object> detail = sectorService.getSectorDetail(id);
    return Result.success(detail);
}
```

### Controller 层返回错误

```java
@PostMapping("/login")
public Result<AuthResponse> login(@Valid @RequestBody LoginRequest request) {
    try {
        AuthResponse response = userService.login(request);
        return Result.success(response);
    } catch (Exception e) {
        return Result.error(401, e.getMessage());
    }
}
```

## 相关 DTO

| DTO | 说明 |
|-----|------|
| `LoginRequest` | 登录请求参数 |
| `RegisterRequest` | 注册请求参数 |
| `AuthResponse` | 认证成功响应（含 Token） |
| `SectorDTO` | 板块数据 |
| `EtfDTO` | ETF 数据 |

## 相关笔记

- [[07-Controller层实现]]
- [[12-API接口文档]]
